---
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import Header from "../components/Header.astro";
import HeroSection from "../components/HeroSection";
import AnimatedBlogCard from "../components/AnimatedBlogCard";
import { SITE_DESCRIPTION, SITE_TITLE } from "../consts";
import { getCollection } from "astro:content";
import "../styles/global.css";

const allPosts = (await getCollection("blog"))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 6);
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    <style is:global>
      @import "../styles/global.css";
    </style>
  </head>
  <body class="bg-white">
    <Header />

    <!-- Hero Section with Framer Motion -->
    <HeroSection client:load />

    <!-- Latest Posts Section -->
    <section
      id="posts"
      class="mx-auto max-w-6xl px-4 py-16 sm:px-6 lg:px-8 lg:py-24"
    >
      <div class="mb-12">
        <h2 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4">
          Latest Articles
        </h2>
        <p class="text-xl text-gray-600">
          Deep dives into engineering challenges and solutions
        </p>
      </div>

      <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {
          allPosts.map((post, index) => (
            <AnimatedBlogCard
              client:load
              title={post.data.title}
              description={post.data.description}
              date={post.data.pubDate.toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })}
              url={`/blog/${post.id}/`}
              index={index}
            />
          ))
        }
      </div>

      <div class="mt-12 text-center">
        <a
          href="/blog"
          class="inline-flex items-center px-6 py-3 rounded-lg border-2 border-gray-300 text-gray-900 font-medium hover:border-blue-600 hover:text-blue-600 transition-colors"
        >
          View All Articles
          <svg
            class="ml-2 w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          </svg>
        </a>
      </div>
    </section>

    <Footer />
  </body>
</html>
